{% extends 'videos/base.html' %}
{% load crispy_forms_tags %}

{% block content %}
    <div class="container">
        <div class="row mt-5"> <!-- mt = margin top -->
            <div class="col-md-8 col-sm-12 col-xs-12">
                <!-- Divide element base on screen size: Medium/Large/Extra large: 8/12 parts of screen
                                                         Small/Extra small: Full size-->
                <video-js
                        class="video-js vjs-default-skin vjs-16-9 vjs-big-play-centered"
                        width="800"
                        height="500"
                        controls
                        data-setup='{"playbackRates": [0.5, 1, 1.5, 2],
                                     "fluid": true,
                                     "preload": "auto"'>
                    <style type="text/css">
                        .video-js .vjs-time-control{display: block;}
                        .video-js .vjs-remaining-time{display: none;}
                    </style>
                    <source src="/media/{{ object.video_file }}" type="video/mp4">
                    <source src="/media/{{ object.video_file }}" type="video/mkv">
                    <p class="vjs-no-js">
                        To view this video please enable JavaScript, and consider upgrading to a web browser that
                        <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
                    </p>
                </video-js>
                <h5 class="mt-4">{{ object.title }}</h5>
                <div class="row">
                    <div class="col-md-6 text-muted">
                        <p>{{ object.date_posted | date:"M d, Y" }}</p>
                    </div>
                    <div class="col-md-6 text-muted text-right">
                        <!-- Button trigger modal -->
                        <ion-icon class="video-icons"
                                  name="share-social-outline"
                                  type="button"
                                  data-toggle="modal"
                                  data-target="#exampleModal">
                            Share
                        </ion-icon>

                        <!-- Modal used for sharing use case-->
                        <div class="modal fade"
                             id="exampleModal"
                             tabindex="-1"
                             role="dialog"
                             aria-labelledby="exampleModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">Share this video</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body text-center">
                                        <ion-icon class="social-share-icons twitter-social-color"
                                                  name="logo-twitter" data-sharer="twitter"
                                                  data-title="Checkout {{ object.title }} by {{ object.uploader }}!"
                                                  data-url="http://127.0.0.1:8000/videos/{{ object.pk }}">
                                            Share on Twitter
                                        </ion-icon>
                                        <ion-icon class="social-share-icons facebook-social-color"
                                                  name="logo-facebook" data-sharer="facebook"
                                                  data-title="Checkout {{ object.title }} by {{ object.uploader }}!"
                                                  data-url="http://127.0.0.1:8000/videos/{{ object.pk }}">
                                            Share on Facebook
                                        </ion-icon>
                                        <ion-icon class="social-share-icons reddit-social-color"
                                                  name="logo-reddit" data-sharer="reddit"
                                                  data-title="Checkout {{ object.title }} by {{ object.uploader }}!"
                                                  data-url="http://127.0.0.1:8000/videos/{{ object.pk }}">
                                            Share on Reddit
                                        </ion-icon>
                                        <p class="mt-3">http://127.0.0.1:8000/videos/{{ object.pk }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <p class="ml-5 mt-3"> {{ object.description }}</p>
            </div>
        </div>
        {% if object.uploader == user %}
            <a class="video-icons icon-color" href="{% url 'video_update' object.pk  %}">
                <ion-icon name="pencil-outline"></ion-icon>
            </a>
            <a class="video-icons icon-color" href="{% url 'video_delete' object.pk  %}">
                <ion-icon name="trash-outline"></ion-icon>
            </a>
        {% endif %}
    </div>
    <div class="container mt-5 mb-5">
        <div class="row mt-3">
            <div class="col-md-8 col-sm-12 col-xs-12">
                {% if user.is_authenticated %}
                    <form method="post">
                        {% csrf_token %}
                        <legend class="border-bottom md-4">Comments</legend>
                        {{ form | crispy }}
                        <div class="col-lg-2 col-md-4 mr-auto">
                            <button class="btn btn-outline-success btn-block">Post</button>
                        </div>
                    </form>
                {% else %}
                    <a class="btn btn-outline-info btn-block" href="{% url 'account_login' %}">
                        Sign in to post a comment.
                    </a>
                {% endif %}
            </div>
        </div>
        {% for comment in comments %}
            <div class="row mt-3">
                <div class="col-md-8 col-sm-12 col-xs-12 border-bottom">
                    <h5>{{ comment.user }}</h5>
                    <p>{{ comment.comment }}</p>
                </div>
                {% if comment.user == request.user %}
                    <form method="post">
                        {% csrf_token %}
                        <button class="btn btn-outline-danger btn-block ml-auto">Delete</button>
                    </form>
                {% endif %}
            </div>
        {% endfor %}
    </div>
{% endblock content %}